!function(e){"use strict";e.fn.scheduleTable=function(t){var a={2:"Thứ 2",3:"Thứ 3",4:"Thứ 4",5:"Thứ 5",6:"Thứ 6",7:"Thứ 7",CN:"Thứ CN",all:"Hàng ngày"};"undefined"==typeof t&&(t={});var s=function(){var t="";t="<table>",t+="<tr>",t+="<th></th>";for(var s=0;8>s;s++)t+='<th colspan="3"><span>'+3*s+"h</span></th>";return t+="</tr>",e.each(a,function(e,a){t+='<tr data-day="'+e+'">';for(var s=0;25>s;s++)t+=0===s?"<th>"+a+"</th>":'<td class="cell"></td>';t+="</tr>"}),t+="</table>"},n=function(e){return 1===e.which||2===e.which};return this.each(function(){var a=e(this);if("get"===t){var l,d,r;return t={},e.each(a.find("[data-day]"),function(a,s){r=e(s).children("td.selected"),r.length>0&&(d=e(this).data("day"),t[d]=[],l=e(s).children("td"),e.each(r,function(e,a){t[d].push(l.index(a)+1)}))}),t}var c=function(t){var a=h.index(e(t.target)),s=(a+1)%24;0===s&&(s=24);var n=Math.ceil((a+1)/24);return{x:s,y:n}};a.html(s());var i,h=a.find(".cell");e.each(t,function(t,a){i="CN"===t?7:"all"===t?8:t-1,e.each(a,function(e,t){h.eq(24*(i-1)+t-1).addClass("selected")})});var f,u,o={};return h.on({mousedown:function(t){if(n(t)){var a=e(t.target);o=c(t),u=8===o.y?!0:!1,a.hasClass("selected")?(a.removeClass("selected"),f=!1):(a.addClass("selected"),f=!0)}},mouseover:function(e){if(n(e)&&"undefined"!=typeof o.x){var t,a,s,l,d=c(e),r=d.x-o.x,i=d.y-o.y;t=r>=0?o.x:o.x+r,a=i>=0?o.y:o.y+i,s=t+Math.abs(r),l=a+Math.abs(i),h.removeClass("_selected _unselect"),u?(a=1,l=8):l>7&&(l=7);for(var v=t;s>=v;v++){for(var C=a;l>=C;C++){var y=h.eq(24*(C-1)+v-1);f?y.addClass("_selected"):y.addClass("_unselect")}f===!1&&h.eq(168+v-1).addClass("_unselect")}}},mouseup:function(t){if(n(t)&&"undefined"!=typeof o.x){o={};var s=c(t);if(u){var l=a.find("td:nth-of-type(24n + "+s.x+")");f?l.addClass("selected"):l.removeClass("selected")}else if(f)for(var d,r=1;24>=r;r++)d=7===a.find("td:nth-of-type(24n + "+r+")").filter(function(t){return null!==e(this).attr("class").match(/selected/)&&7>t}).length,d&&h.eq(168+r-1).addClass("_selected");else h.eq(168+s.x-1).addClass("_unselect");h.siblings("._selected").removeClass("_selected").addClass("selected"),h.siblings("._unselect").removeClass("_unselect selected")}}}),this})}}(jQuery);